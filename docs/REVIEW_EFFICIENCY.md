# レビュー効率

**PRの各ステータスにおける滞留時間**を計測します。

```
Ready for Review ───→ First Review ───→ Approved ───→ Merged
      │                    │                │            │
      │←─ レビュー待ち時間 ─→│←─ レビュー時間 ─→│←マージ待ち→│
      │                                                    │
      └────────────────── 全体時間 ─────────────────────────┘
```

---

## なぜ計測するのか

- **AIコード品質の可視化**: レビュー時間が長い = AIコードが難解な可能性
- **ボトルネックの特定**: どのフェーズで時間がかかっているかを把握
- **チーム効率の測定**: レビュー文化・速度の可視化

---

## 使い方

```javascript
// 過去30日間のレビュー効率を計測（デフォルト）
syncReviewEfficiency();

// 過去90日間
syncReviewEfficiency(90);
```

---

## 出力されるシート

### 「Review Efficiency」シート（サマリー）

| Period | PR Count | Time to First Review (Avg) | Review Duration (Avg) | Time to Merge (Avg) | Total Time (Avg) |
|--------|----------|---------------------------|----------------------|--------------------|-----------------| 
| 2024-01-01〜01-31 | 25 | 3.5 | 12.4 | 2.1 | 18.0 |

### 「Review Efficiency - Details」シート（PR詳細）

| PR # | Title | Ready For Review At | First Review At | Approved At | Time to First Review (h) | Review Duration (h) |
|------|-------|---------------------|-----------------|-------------|--------------------------|---------------------|
| 123 | Feature X | 2024-01-10T... | 2024-01-10T... | 2024-01-11T... | 2.5 | 8.0 |

---

## 推奨値

| 指標 | 推奨値 |
|------|--------|
| レビュー待ち時間 | 4時間以内 |
| レビュー時間 | 24時間以内 |

---

## AIとレビュー効率

AIコードが読みやすい場合:
```
レビュー待ち時間: 2時間
レビュー時間: 4時間     ← 短い = 理解しやすい
```

AIコードが難解な場合:
```
レビュー待ち時間: 2時間
レビュー時間: 48時間    ← 長い = 理解に時間がかかる
```

### 改善アクション

| 観点 | 原因 | アクション |
|------|------|-----------|
| レビュー時間の増加 | AIコードが難解 | プロンプト改善、コード説明追加 |
| レビュー待ち時間の増加 | レビュアー不足 | レビュー担当の分散 |

---

## トラブルシューティング

### レビュー時間がnull

- レビューなしでマージされたPR（セルフマージなど）

### Ready for Reviewが古い

- Timeline API制限（古いPRでは `ready_for_review` イベントが取得できない場合があります）
- その場合、PR作成日時にフォールバックします

---

## 参考資料

- [SPACE Framework](https://queue.acm.org/detail.cfm?id=3454124) - Efficiency, Collaboration
- [LinearB - Cycle Time](https://linearb.io/blog/cycle-time) - Review Time
